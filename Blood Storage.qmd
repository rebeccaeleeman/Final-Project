---
title: "Blood Storage"
format: pdf
editor: visual
---

###Linear regression 

Conditions: 

Independence: The independence condition appears to be met, as stated in the methodology.

Checking linearity and equal variance
```{r}
library(tidyverse)
blood <- read.csv("BloodStorage.csv")
blood$RBC.Age.Group <- factor(blood$RBC.Age.Group,
                              levels = c(1, 2, 3),
                              labels = c("Younger", "Middle", "Older"))
blood$AA <- factor(blood$AA, labels = c("Non-AA", "AA"))
blood$FamHx <- factor(blood$FamHx, labels = c("No", "Yes"))
blood$T.Stage <- factor(blood$T.Stage)
blood$bGS <- factor(blood$bGS)
blood$AnyAdjTherapy <- factor(blood$AnyAdjTherapy, labels = c("No", "Yes"))
blood$AdjRadTherapy <- factor(blood$AdjRadTherapy, labels = c("No", "Yes"))


lm_mod_full <- lm(TimeToRecurrence ~ RBC.Age.Group + Age + AA + FamHx + 
                    PVol + TVol + T.Stage + bGS + PreopPSA + Units + 
                    AnyAdjTherapy + AdjRadTherapy, data = blood)

ggplot(lm_mod_full, aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(
    title = "Residuals vs Fitted",
    x = "Fitted Values",
    y = "Residuals"
  ) +
  theme_minimal()
```
Interpretation: 
The residuals do not appear randomly scattered around the zero line. Instead, they show visible structure and changing spread across fitted values, indicating a non-linear relationship between predictors and the outcome. Also, the spread of residuals increases with fitted values, forming a funnel-like pattern that suggests heteroscedasticity (unequal variance of residuals across levels of the fitted values). 
Neither linearity not equal variance are met.  
 
Checking normality of residuals 


```{r}
ggplot(lm_mod_full, aes(.resid)) +
  geom_histogram(bins = 10, aes(y = ..density..)) +
  geom_density(color = "blue") +
  labs(title = "Histogram of Residuals")
```
Interpretation: Normality is not met, as the plot is right skewed with most residuals clustered near 0 and a longer tail extending to the right. This suggests that the residuals are not normally distributed. 


Even though the assumptions for linear regression were not met, we can continue with testing, but inference and significance tests should be interpreted carefully given these unmet assumptions. 


Running the regression 
```{r}

summary(lm_mod_full)

```
The multiple linear regression results show that, after adjusting for demographic, pathological, and clinical covariates, RBC storage age (both “Middle” and “Older” groups) was not significantly associated with Time to Recurrence (p=0.2189 and p=0.9177, respectively). 
Among the covariates, higher baseline Gleason scores were strongly associated with shorter recurrence times (p=0.0001), meaning that tumor aggressiveness might be more influential to shorter recurrence times. This is an important point and could require further testing. 
